\subsection{ESKF}
The human brain is a brilliant filter fusing multiple senses together to create what we perceive. Even in the absence of vision, we can perform dead reckoning to get an idea of how we are moving.
Robots have the same need when navigating and we do not have any single perfect sensor that can fully provide us with the the pose at any time. We therefore want a filter that can fuse multiple data sources together to create an a robust and accurate estimate for our robot, similar to how perception works in a human brain.

We will therefore develop the \texttt{error state kalman filter} (ESKF) to estimate the location and orientation of an aeroplane using intertial navigation. The vehicle uses an \texttt{inertial measurement unit} (IMU) to sense acceleration and rotation rate using an accelerometer and a rate gyro. Similar to a human with his/her eyes closed, the filter is able to predict pose using only the IMU if the prior state is known, but with an increasing error and corresponding uncertianty. We will therefore also use a GNSS receiver to update our estimate when we receive new measurements.

A normal EKF, which might be tempting to use, struggles with representing the error state covariance due to the nonlinearity which occurs when working with orientation. We therefore use our measurements to estimate the error state directly. We then use our model to simulate the nominal state using numerical integration methods. After measurement updates we get estimates for the error states which we can inject into our nominal state predictions and correct for any model or simulation errors. After the injection step the error can be reset back to zero and we avoid having to propogate the error.
By doing this we avoid having to find a relationship between the error state covariance and the nominal state covariance (not trivial when working with attitude), since we can get the covariance directly from the ESKF. We can also use different representations for orientation internally when working with the nominal states and the error states. In our case we use a quaternion representation in the nominal states, but use a 3-dimensional representation for the error state. Quaternion representation is over-parameterized and introduces additional challenges when using the covariance matrix. The error is assumed to be low, so there is no reason to worry about any singluarity issues of 3-dimensional representations.

We also consider the IMU measurement as control input to our model and not as measurements. Measurements would require us to include the acceleration and orientation rates as part of the state vector, and we do not have any good model for these. The computational complexity would also increase due to the high rate of IMU measurements.
